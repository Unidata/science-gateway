imagePullSecret:
  create: true
  registry: https://index.docker.io/v1/
  username: xxx
  password: xxx

hub:
  cookieSecret: xxx
  config:
    Authenticator:
      admin_users:
      - admins
      allowed_users:
      - users
      allow_existing_users: true
    GitHubOAuthenticator:
      client_id: xxx
      client_secret: xxx
      oauth_callback_url: https://snu25f.ees220002.projects.jetstream-cloud.org:443/oauth_callback
    JupyterHub:
      authenticator_class: github

proxy:
  secretToken: xxx

ingress:
  enabled: true
  annotations:
    kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: letsencrypt
    nginx.ingress.kubernetes.io/proxy-body-size: 500m
  hosts:
  - snu25f.ees220002.projects.jetstream-cloud.org
  tls:
  - hosts:
    - snu25f.ees220002.projects.jetstream-cloud.org
    secretName: certmanager-tls-jupyterhub

scheduling:
  corePods:
    tolerations:
    - key: hub.jupyter.org/dedicated
      operator: Equal
      value: core
      effect: NoSchedule
    - key: hub.jupyter.org_dedicated
      operator: Equal
      value: core
      effect: NoSchedule
    nodeAffinity:
      matchNodePurpose: require
  podPriority:
    enabled: true
  userPlaceholder:
    replicas: 4

singleuser:
  extraContainers:
  - name: cave-idv-sidecar
    image: docker.io/unidata/cave-idv-sidecar:2025Aug14_201214_7e09
    volume_mounts:
    - mountPath: /home/jovyan
      name: volume-{username}
    - mountPath: /share
      name: nfs-volume
      readOnly: false
    ports:
    - containerPort: '6080'
      name: novnc
    resources:
      requests:
        cpu: 250m
        memory: 512Mi
      limits:
        cpu: '1'
        memory: 1Gi
  extraEnv:
    NBGITPULLER_DEPTH: '0'
    START_VIRTUAL_DESKTOP: '1'
  start_timeout: 600
  storage:
    volumes: volumes
  memory:
    guarantee: 13GiB
    limit: 16GiB
  cpu:
    guarantee: '3.25'
    limit: '4'
  defaultUrl: /lab
  image:
    name: unidata/snu25f
    tag: xxx
  lifecycleHooks:
    postStart:
      exec:
        command:
        - bash
        - -c
        - dir="/home/jovyan/.ssh"; [ -d $dir ] && { chmod 700 $dir && chmod -f 600 $dir/* && chmod -f 644 $dir/*.pub; } || true;
        - cp -t /home/jovyan /Acknowledgements.ipynb \
        - '  /update_material.ipynb /additional_kernels.ipynb;'
        - python /default_kernel.py $DEFAULT_ENV_NAME /home/jovyan;
        - '[[ -f $HOME/.bashrc ]] || cp /etc/skel/.bashrc $HOME/;'
        - '[[ -f $HOME/.profile ]] || cp /etc/skel/.profile $HOME/;'
        - '[[ -f $HOME/.bash_logout ]] || cp /etc/skel/.bash_logout $HOME/;'
        - '[[ -f $HOME/.condarc ]] || cp /.condarc $HOME/;'
        - '[ -d "/share" ] && [ ! -L ~/share ] && ln -s /share ~/share || true;'
  profileList:
  - display_name: Standard
    description: Up to 2 CPU, 8GiB RAM
    kubespawner_override:
      mem_guarantee: 6.25Gi
      mem_limit: 8Gi
      cpu_guarantee: 1.5
      cpu_limit: 2
      node_selector:
        capi.stackhpc.com/node-group: mediums
    default: true
  - display_name: 'Virtual Desktop: Run IDV & CAVE'
    description: 'Jupyter: 3 GB of memory; 1 vCPUS, IDV/CAVE: 21 GB of memory; 6 vCPUS'
    kubespawner_override:
      mem_guarantee: 3Gi
      mem_limit: 3Gi
      cpu_guarantee: 1
      cpu_limit: 1
      node_selector:
        capi.stackhpc.com/node-group: mediums
      extra_containers:
      - name: cave-idv-sidecar
        image: docker.io/unidata/cave-idv-sidecar:2025Aug14_201214_7e09
        volume_mounts:
        - mountPath: /home/jovyan
          name: volume-{username}
        - mountPath: /share
          name: nfs-volume
          readOnly: false
        ports:
        - containerPort: '6080'
          name: novnc
        resources:
          requests:
            cpu: '6'
            memory: 21Gi
          limits:
            cpu: '6'
            memory: 21Gi
