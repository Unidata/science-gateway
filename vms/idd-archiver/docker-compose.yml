version: '3'

services:

  ###
  # LDM
  ###
  ldm:
    image: unidata/ldm-docker:6.13.6
    container_name: ldm
    # restart: always
    volumes:
      - ~/etc/:/home/ldm/etc/
      - /data/:/home/ldm/var/data/
      - /data/:/data/
      - /data/queues:/home/ldm/var/queues/
      - /data/logs/ldm/:/home/ldm/var/logs/
      - ./cron/:/var/spool/cron/
    ports:
      - "388:388"
    ulimits:
      nofile:
        soft: 64
        hard: 64
  
  ###
  # TDM
  ###
  tdm:
    image: unidata/tdm-docker:4.6
    container_name: tdm
    # restart: always
    volumes:
        - /data/:/data/
        - ~/tdsconfig/:/usr/local/tomcat/content/thredds/
        - ~/logs/tdm/:/usr/local/tomcat/content/tdm/
    env_file:
        - "compose${THREDDS_COMPOSE_ENV_LOCAL}.env"
